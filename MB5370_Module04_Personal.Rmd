---
title: "MB5370_Module_04_JC"
author: "James Coon"
date: "2025-03-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Module 4, Data Science in R

### Load Packages
```{r Load Packages}
install.packages("tidyverse", 'ggplot2')
library(tidyverse, ggplot2)
```

### Load Data
```{r mpg}
mpg
```

### Create first plot
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```

### Graphing Template:

ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))

```{r Graphing}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = class)) #color by class!

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class)) #point size by class!

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class)) #alpha is transparency, thus transparency by class!

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class)) #point shape by class!

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = "blue") #can manually make all points whatever color you want!
```
What happens if aes(colour = displ < 5)?
It creates a legend which displays values over a 5 dspl in turquoise and under in red.
```{r Question}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = displ < 5))
```

### Facets and Panel Plots

Creates plots in a grid format, where it's easier to compare them.
```{r Facets and Panel Plots}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2) #Creates 2 rows, regardless of amount of variables/plots

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(. ~ cyl) #If showing more than 1 variable as a row, use facet_grid instead of facet_wrap.

```
Exercise-

What does ncol and nrow do?
They choose the number of columns and rows respectively.

What other options control the layout of the individual panels? 
Reorder and as.table

## Fitting Simple Lines

```{r Fitting Simple Lines}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) #Plot as points

ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy)) #Plot as smooth line! geom_smooth

ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv)) #Can change plot line by class!

ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv, color=drv, linetype = drv)) #Change some aesthetic based on drv

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy)) #Plots both line and points. Must just be used additively

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth() #Same as above, but more efficient

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth() #Style each point individually based upon many variables
```

#### Exercise

1. What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?
line cart- geom_smooth
boxplot- geom_boxplot
histogram- geom_histogram or geom_bar

2. Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.
```{r Exercise}
#I predict both graphs will be the same.

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()

ggplot() + 
  geom_point(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_smooth(data = mpg, mapping = aes(x = displ, y = hwy))
```

3. Will these two graphs look different? Why/why not?
No, because the specifications made in the second plot are listed in the first plot.  The first plot is simply more efficient because the specifications only have to be typed once.

## Transformations and Stats

```{r}
ggplot(data = diamonds) + #data found in ggplot2
  geom_bar(mapping = aes(x = cut))

ggplot(data = diamonds) + 
  stat_count(mapping = aes(x = cut)) #can often use stat and geom interchangeably
```
#### Overriding Defaults
```{r Overriding defaults}
demo <- tribble( #tribble is basically a dataframe
  ~cut,         ~freq,
  "Fair",       1610,
  "Good",       4906,
  "Very Good",  12082,
  "Premium",    13791,
  "Ideal",      21551
)
demo

ggplot(data = demo) +
  geom_bar(mapping = aes(x = cut, y = freq), stat = 'identity') #default stat is count

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = stat(prop), group = 1)) # y is a proportion rather than raw count
  
```

#### Plotting Statistical Details

Showing statistical summaries is a good ideal for transparency of your work
```{r}

ggplot(data = diamonds) + 
  stat_summary(  #Shows error bars when specified
    mapping = aes(x = cut, y = depth),
    fun.min = min,
    fun.max = max,
    fun = median)
```

## Aesthetic Adjustments

You can use commands such as color or fill to customize bars.
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, colour = cut)) #only outline is colored

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = cut)) #Fills bars

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity)) #Stacks clarity coloration into existing bars!

ggplot(data = diamonds) +
(mapping = aes(x = cut, fill = clarity)) + 
  geom_bar(alpha = 1/5, position = "identity") #Alpha alters transparency

ggplot(data = diamonds) + 
  (mapping = aes(x = cut, colour = clarity)) + 
  geom_bar(fill = NA, position = "identity") #Transparent bars and colored outline.

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill") #Similar to stacking, but makes all the bars the same height.

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "dodge") #Dodge puts overlapping objects next to eachother instead of overlapping.

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), position = "jitter") #Jitter makes random noise in the plot to slightly and randomly space data out and make it mroe visible.
```

##The layered grammar of graphics

An updated plot template:

ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(
     mapping = aes(<MAPPINGS>),
     stat = <STAT>, 
     position = <POSITION>
  ) +
  <FACET_FUNCTION>

## ASSIGNMENT

IMPORT DATASET
```{r}
library(readxl)
API_ER_FSH_AQUA_MT_DS2_en_excel_v2_967 <- read_excel("C:/Users/jacoo/Downloads/API_ER.FSH.AQUA.MT_DS2_en_excel_v2_967.xls", 
    sheet = "Sheet2")
View(API_ER_FSH_AQUA_MT_DS2_en_excel_v2_967)
JA_Fisheries <- API_ER_FSH_AQUA_MT_DS2_en_excel_v2_967
```

Alter the plot!
```{r Assignment exercise}
JA_Fisheries$Year<- as.numeric(JA_Fisheries$Year) #This held us up for a half hour lol.  Need to assign to the data sheet, not just as.numeric(data)
JA_Fisheries <- na.omit(JA_Fisheries)
str(JA_Fisheries$Year)
ggplot(data= JA_Fisheries) + 
 geom_point(mapping = aes(x= Year, y= Japan), color="black", shape = "Australia") +
 geom_point(mapping = aes(x= Year, y= Australia), color="grey", shape = "Japan") +
 geom_smooth(aes(x= Year, y= Japan), color="black", method='loess') +
  geom_smooth(aes(x= Year, y= Australia), color="grey", method='loess') +
labs(y = "Aquaculture Production (Metric Tons)", x = "Year", shape = "Country")
```

```{r}
ggplot(data = JA_Fisheries) + 
  geom_point(aes(x = Year, y = Japan, color = "Japan", shape = "Japan")) +
  geom_point(aes(x = Year, y = Australia, color = "Australia", shape = "Australia")) +
  geom_smooth(aes(x = Year, y = Japan, color = "Japan"), method = "loess") +
  geom_smooth(aes(x = Year, y = Australia, color = "Australia"), method = "loess") +
  labs(y = "Fish Catch (tons)", x = "Year", color = "Country", shape= "Country")  # Legend title
```

#Workshop 2


